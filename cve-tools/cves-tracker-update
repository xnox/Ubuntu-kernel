#!/usr/bin/python
#
# cves-tracker-update -- merge tracker updates
#
import sys
from subprocess import Popen, PIPE
import os.path

here = os.path.dirname(sys.argv[0])

args = sys.argv
args[0] = here + "/cve-tracker-update"

# cves[cve_num] = [ entry, ... ]
cves = {}

for line in sys.stdin:
    (cve_num, entry) = line.split(None, 1)
    if cve_num not in cves:
        cves[cve_num] = ''
    cves[cve_num] += entry

for cve_num in cves:
    print cve_num
    print cves[cve_num]

    cmd = args + [ cve_num ]
    p = Popen(cmd, stdin=PIPE)
    p.stdin.write(cves[cve_num])
    p.stdin.close()

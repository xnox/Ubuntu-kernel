#!/bin/bash

while read from tos
do
	grep -H "^$from:" "$@" | \
		sed -e 's/:/ /' | \
		while read file dummy state notes
		do
			case "$state" in
			pending|released|not-affected|needed)
				if [ "$state" = "released" ]; then
					state='pending'
				fi
				for to in $tos
				do
					to=`echo "$to" | sed -e 's/_linux-/ /'`
					echo "$file $to - $state"
				done
				;;
			esac
		done
done <<EOL
lucid_linux		lucid_linux-ec2 lucid_linux-mvl-dove maverick_linux-mvl-dove
maverick_linux		lucid_linux-lts-backport-maverick
natty_linux		lucid_linux-lts-backport-natty
oneiric_linux		lucid_linux-lts-backport-oneiric oneiric_linux-ti-omap4 precise_linux-ti-omap4
EOL

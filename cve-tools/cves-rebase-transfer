#!/bin/bash

while read from tos
do
	grep -H "^$from:" "$@" | \
		sed -e 's/:/ /' | \
		while read file dummy state notes
		do
			case "$state" in
			released|not-affected)
				state='pending' ;;
			esac
			case "$state" in
			pending|needed)
				for to in $tos
				do
					to=`echo "$to" | sed -e 's/_linux-/ /'`
					echo "$file $to - $state"
				done
				;;
			esac
		done
done <<EOL
lucid_linux		lucid_linux-ec2
natty_linux		lucid_linux-lts-backport-natty
oneiric_linux		lucid_linux-lts-backport-oneiric oneiric_linux-ti-omap4
devel_linux		devel_linux-ti-omap4
EOL
